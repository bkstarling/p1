<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STRATX Report Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton+SC&family=Space+Grotesk:wght@400;500;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: #0a0d14;
            min-height: 100vh;
            color: #e2e8f0;
        }

        .app-container {
            display: grid;
            grid-template-columns: 460px 1fr;
            height: 100vh;
        }

        /* Form Section */
        .form-section {
            background: #0f1420;
            padding: 32px;
            overflow-y: auto;
            border-right: 1px solid rgba(255,255,255,0.07);
        }

        .form-header {
            margin-bottom: 28px;
            padding-bottom: 22px;
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }

        .form-header h1 {
            font-size: 22px;
            font-weight: 700;
            color: #f1f5f9;
            margin-bottom: 5px;
            letter-spacing: -0.3px;
        }

        .form-header p {
            color: #475569;
            font-size: 13px;
        }

        /* Card wrapper for form sections */
        .form-card {
            background: #161c2d;
            border: 1px solid rgba(255,255,255,0.07);
            border-radius: 12px;
            padding: 18px 20px;
            margin-bottom: 14px;
        }

        .form-section-title {
            font-size: 11px;
            font-weight: 700;
            color: #475569;
            margin-bottom: 14px;
            text-transform: uppercase;
            letter-spacing: 1.2px;
        }

        .form-group {
            margin-bottom: 14px;
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        .form-group label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: #94a3b8;
            margin-bottom: 6px;
            letter-spacing: 0.3px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px 13px;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s;
            font-family: 'Space Grotesk', sans-serif;
            background: #0f1420;
            color: #e2e8f0;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.12);
        }

        .form-group input[type="number"] {
            font-family: 'DM Mono', monospace;
        }

        .form-group select option {
            background: #161c2d;
        }

        .form-group small {
            display: block;
            margin-top: 5px;
            font-size: 11px;
            color: #475569;
        }

        /* Theme Buttons */
        .theme-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .theme-btn {
            padding: 0;
            border: 2px solid rgba(255,255,255,0.08);
            border-radius: 10px;
            background: #0f1420;
            cursor: pointer;
            transition: all 0.2s;
            overflow: hidden;
        }

        .theme-btn:hover {
            border-color: rgba(255,255,255,0.2);
        }

        .theme-btn.active {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .theme-preview-strip {
            height: 36px;
            width: 100%;
        }

        .theme-label {
            padding: 7px 6px;
            font-size: 10px;
            font-weight: 600;
            color: #64748b;
            text-align: center;
        }

        .theme-btn.active .theme-label {
            color: #60a5fa;
        }

        .download-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 16px;
            transition: all 0.2s;
            font-family: 'Space Grotesk', sans-serif;
            letter-spacing: 0.3px;
        }

        .download-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.35);
        }

        .download-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Preview Section */
        .preview-section {
            background: #070b12;
            padding: 40px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .preview-header {
            margin-bottom: 28px;
        }

        .preview-header h2 {
            font-size: 20px;
            font-weight: 700;
            color: #f1f5f9;
            margin-bottom: 4px;
        }

        .preview-header p {
            color: #475569;
            font-size: 13px;
        }

        .preview-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Report Card Styles */
        .report-card {
            width: 700px;
            height: 700px;
            padding: 32px 50px 44px 50px;
            border-radius: 0;
            font-family: 'Space Grotesk', sans-serif;
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.6);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .report-header {
            text-align: center;
        }

        .logo-centered {
            display: flex;
            justify-content: center;
            margin-bottom: 16px;
        }

        .logo {
            max-width: 270px;
            max-height: 130px;
            object-fit: contain;
            object-position: center;
        }

        .report-title {
            font-size: 20px;
            font-weight: 900;
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 0;
            opacity: 0.95;
            font-family: 'Anton SC', sans-serif;
        }

        .date-section {
            padding-top: 14px;
            padding-bottom: 14px;
            text-align: center;
            border-bottom: 1px solid;
        }

        .date-badge {
            display: inline-block;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 0.5px;
            opacity: 0.8;
        }

        .metrics-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 0;
            padding: 8px 0;
        }

        /* Metric card rows */
        .metric-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 13px 18px;
            border-radius: 10px;
            margin-bottom: 8px;
        }

        .metric-row:last-child {
            margin-bottom: 0;
        }

        .metric-label {
            font-size: 13px;
            font-weight: 700;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            opacity: 0.7;
        }

        .metric-value {
            font-size: 20px;
            font-weight: 700;
            font-family: 'DM Mono', monospace;
            display: flex;
            align-items: center;
            gap: 8px;
            letter-spacing: -0.5px;
        }

        .metric-value.large {
            font-size: 22px;
        }

        .metric-value.xlarge {
            font-size: 24px;
        }

        .arrow-icon {
            font-size: 13px;
            line-height: 1;
            opacity: 0.9;
        }

        .disclaimer {
            padding: 12px 16px;
            border-radius: 8px;
            text-align: center;
            font-size: 9px;
            line-height: 1.6;
        }

        .disclaimer strong {
            font-weight: 900;
            font-size: 9.5px;
            letter-spacing: 0.5px;
        }

        /* Scrollbar */
        .form-section::-webkit-scrollbar,
        .preview-section::-webkit-scrollbar {
            width: 6px;
        }

        .form-section::-webkit-scrollbar-track,
        .preview-section::-webkit-scrollbar-track {
            background: transparent;
        }

        .form-section::-webkit-scrollbar-thumb,
        .preview-section::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef } = React;

        const BG_PRESETS = {
            dark_blue: {
                name: 'Midnight Blue',
                gradient: 'linear-gradient(160deg, #0b1437 0%, #0d1f4a 50%, #091232 100%)',
                cardBg: 'rgba(255,255,255,0.06)',
                cardBorder: 'rgba(96, 165, 250, 0.15)',
                textColor: '#e2f0ff',
                subText: 'rgba(226, 240, 255, 0.55)',
                accentLine: 'rgba(96, 165, 250, 0.25)',
                disclaimerBg: 'rgba(0,0,0,0.3)',
                highlightCard: 'rgba(59,130,246,0.12)',
                highlightBorder: 'rgba(96,165,250,0.3)',
            },
            dark_slate: {
                name: 'Carbon Slate',
                gradient: 'linear-gradient(160deg, #111318 0%, #1a1d27 50%, #0d0f17 100%)',
                cardBg: 'rgba(255,255,255,0.05)',
                cardBorder: 'rgba(148,163,184,0.12)',
                textColor: '#e8eaf0',
                subText: 'rgba(232, 234, 240, 0.5)',
                accentLine: 'rgba(148,163,184,0.2)',
                disclaimerBg: 'rgba(0,0,0,0.35)',
                highlightCard: 'rgba(255,255,255,0.08)',
                highlightBorder: 'rgba(148,163,184,0.25)',
            },
            dark_forest: {
                name: 'Obsidian Green',
                gradient: 'linear-gradient(160deg, #081a12 0%, #0d2318 50%, #061510 100%)',
                cardBg: 'rgba(255,255,255,0.05)',
                cardBorder: 'rgba(52, 211, 153, 0.15)',
                textColor: '#d4f0e4',
                subText: 'rgba(212, 240, 228, 0.5)',
                accentLine: 'rgba(52, 211, 153, 0.2)',
                disclaimerBg: 'rgba(0,0,0,0.3)',
                highlightCard: 'rgba(52,211,153,0.1)',
                highlightBorder: 'rgba(52,211,153,0.3)',
            }
        };

        function App() {
            const [formData, setFormData] = useState({
                date: new Date().toISOString().split('T')[0],
                reportType: 'daily',
                totalCapital: '120000000',
                todayPL: '16500',
                todayROI: '0.14',
                monthPL: '424008',
                monthROI: '3.53',
                disclaimer: 'Personal trades for transparency only. Broker-verified, publicly accessible. Not financial advice. Trading involves risk. Past performance does not guarantee future results.'
            });

            const [bgScheme, setBgScheme] = useState('dark_blue');
            const [logo, setLogo] = useState(null);
            const [uploading, setUploading] = useState(false);
            const reportRef = useRef(null);

            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const handleLogoUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => setLogo(reader.result);
                    reader.readAsDataURL(file);
                }
            };

            const formatCurrency = (value) => {
                const num = parseFloat(value);
                if (isNaN(num)) return '‚Çπ0';
                const absNum = Math.abs(num);
                if (absNum >= 10000000) return `‚Çπ${(num / 10000000).toFixed(2)} Cr`;
                if (absNum >= 100000) return `‚Çπ${(num / 100000).toFixed(2)} L`;
                return `‚Çπ${num.toLocaleString('en-IN')}`;
            };

            const formatDate = (dateString) => {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-IN', { day: '2-digit', month: 'short', year: 'numeric' });
            };

            const downloadReport = async () => {
                if (reportRef.current) {
                    setUploading(true);
                    try {
                        const canvas = await html2canvas(reportRef.current, {
                            scale: 4,
                            backgroundColor: null,
                            logging: false,
                            useCORS: true,
                            allowTaint: true,
                        });
                        const link = document.createElement('a');
                        link.download = `STRATX_Report_${formData.date}.png`;
                        link.href = canvas.toDataURL('image/png');
                        link.click();
                    } catch (error) {
                        alert('Error generating image. Please try again.');
                    } finally {
                        setUploading(false);
                    }
                }
            };

            const getPLColor = (value) => {
                const num = parseFloat(value);
                if (num > 0) return '#34d399';
                if (num < 0) return '#f87171';
                return '#94a3b8';
            };

            const getPLSign = (value) => parseFloat(value) > 0 ? '+' : '';

            const getArrow = (value) => {
                const num = parseFloat(value);
                if (num > 0) return '‚ñ≤';
                if (num < 0) return '‚ñº';
                return '‚óè';
            };

            const getReportTitle = () => formData.reportType === 'daily' ? "Today's Overview" : "Monthly Overview";

            const p = BG_PRESETS[bgScheme];

            const metrics = [
                { label: 'Total Capital', value: formatCurrency(formData.totalCapital), raw: formData.totalCapital, isCapital: true, size: 'xlarge' },
                { label: "Today's P&L", value: `${getPLSign(formData.todayPL)}${formatCurrency(formData.todayPL)}`, raw: formData.todayPL, isPL: true, size: 'xlarge' },
                { label: "Today's ROI", value: `${getPLSign(formData.todayROI)}${formData.todayROI}%`, raw: formData.todayROI, isPL: true, size: 'large' },
                { label: 'Month P&L', value: `${getPLSign(formData.monthPL)}${formatCurrency(formData.monthPL)}`, raw: formData.monthPL, isPL: true, size: 'large' },
                { label: 'Month ROI', value: `${getPLSign(formData.monthROI)}${formData.monthROI}%`, raw: formData.monthROI, isPL: true, size: 'large' },
            ];

            return (
                <div className="app-container">
                    {/* FORM PANEL */}
                    <div className="form-section">
                        <div className="form-header">
                            <h1>üìä STRATX Generator</h1>
                            <p>Create professional trading reports</p>
                        </div>

                        {/* Report Type */}
                        <div className="form-card">
                            <div className="form-section-title">Report Type</div>
                            <div className="form-group">
                                <label>Type</label>
                                <select name="reportType" value={formData.reportType} onChange={handleInputChange}>
                                    <option value="daily">Today's Overview</option>
                                    <option value="monthly">Monthly Overview</option>
                                </select>
                            </div>
                            <div className="form-group">
                                <label>Date</label>
                                <input type="date" name="date" value={formData.date} onChange={handleInputChange} />
                            </div>
                        </div>

                        {/* Capital & Performance */}
                        <div className="form-card">
                            <div className="form-section-title">Capital & Performance</div>
                            <div className="form-group">
                                <label>Total Capital (‚Çπ)</label>
                                <input type="number" name="totalCapital" value={formData.totalCapital} onChange={handleInputChange} placeholder="120000000" />
                            </div>
                            <div className="form-group">
                                <label>Today's P&L (‚Çπ)</label>
                                <input type="number" name="todayPL" value={formData.todayPL} onChange={handleInputChange} placeholder="16500" />
                            </div>
                            <div className="form-group">
                                <label>Today's ROI (%)</label>
                                <input type="number" step="0.01" name="todayROI" value={formData.todayROI} onChange={handleInputChange} placeholder="0.14" />
                            </div>
                            <div className="form-group">
                                <label>Month P&L (‚Çπ)</label>
                                <input type="number" name="monthPL" value={formData.monthPL} onChange={handleInputChange} placeholder="424008" />
                            </div>
                            <div className="form-group">
                                <label>Month ROI (%)</label>
                                <input type="number" step="0.01" name="monthROI" value={formData.monthROI} onChange={handleInputChange} placeholder="3.53" />
                            </div>
                        </div>

                        {/* Logo */}
                        <div className="form-card">
                            <div className="form-section-title">Logo</div>
                            <div className="form-group">
                                <label>Upload Logo</label>
                                <input type="file" accept="image/png,image/jpeg,image/jpg" onChange={handleLogoUpload} />
                                <small>PNG with transparent background recommended</small>
                            </div>
                        </div>

                        {/* Theme */}
                        <div className="form-card">
                            <div className="form-section-title">Color Theme</div>
                            <div className="theme-grid">
                                {Object.entries(BG_PRESETS).map(([key, preset]) => (
                                    <button
                                        key={key}
                                        type="button"
                                        className={`theme-btn ${bgScheme === key ? 'active' : ''}`}
                                        onClick={() => setBgScheme(key)}
                                    >
                                        <div className="theme-preview-strip" style={{ background: preset.gradient }}></div>
                                        <div className="theme-label">{preset.name}</div>
                                    </button>
                                ))}
                            </div>
                        </div>

                        {/* Disclaimer */}
                        <div className="form-card">
                            <div className="form-section-title">Disclaimer</div>
                            <div className="form-group">
                                <textarea name="disclaimer" value={formData.disclaimer} onChange={handleInputChange} rows="4" />
                            </div>
                        </div>

                        <button type="button" className="download-btn" onClick={downloadReport} disabled={uploading}>
                            {uploading ? '‚è≥ Generating...' : 'üì• Download Report PNG'}
                        </button>
                    </div>

                    {/* PREVIEW PANEL */}
                    <div className="preview-section">
                        <div className="preview-header">
                            <h2>Live Preview</h2>
                            <p>Your report will look exactly like this</p>
                        </div>

                        <div className="preview-container">
                            <div
                                ref={reportRef}
                                className="report-card"
                                style={{ background: p.gradient, color: p.textColor }}
                            >
                                {/* Header */}
                                <div className="report-header">
                                    <div className="logo-centered">
                                        {logo && <img src={logo} alt="Logo" className="logo" crossOrigin="anonymous" />}
                                    </div>
                                    <div className="report-title" style={{ color: p.textColor }}>
                                        {getReportTitle()}
                                    </div>
                                    <div className="date-section" style={{ borderBottomColor: p.accentLine }}>
                                        <div className="date-badge" style={{ color: p.subText }}>
                                            {formatDate(formData.date)}
                                        </div>
                                    </div>
                                </div>

                                {/* Metrics */}
                                <div className="metrics-section">
                                    {metrics.map((m, i) => {
                                        const isHighlight = i === 0 || i === 1;
                                        return (
                                            <div
                                                key={i}
                                                className="metric-row"
                                                style={{
                                                    background: isHighlight ? p.highlightCard : p.cardBg,
                                                    border: `1px solid ${isHighlight ? p.highlightBorder : p.cardBorder}`,
                                                }}
                                            >
                                                <span className="metric-label" style={{ color: p.subText }}>
                                                    {m.label}
                                                </span>
                                                <span
                                                    className={`metric-value ${m.size}`}
                                                    style={{ color: m.isPL ? getPLColor(m.raw) : p.textColor }}
                                                >
                                                    {m.isPL && (
                                                        <span className="arrow-icon">{getArrow(m.raw)}</span>
                                                    )}
                                                    {m.value}
                                                </span>
                                            </div>
                                        );
                                    })}
                                </div>

                                {/* Disclaimer */}
                                <div
                                    className="disclaimer"
                                    style={{ background: p.disclaimerBg, color: p.subText }}
                                >
                                    <p><strong style={{ color: p.textColor, opacity: 0.7 }}>DISCLAIMER:</strong> {formData.disclaimer}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
